### 引导页

15min

##### dialog的控件find的时候一定要记得用view.findViewbyId()

##### 配置完application一定要去manifest.xml内设置application-name



### 请求

##### 内置接口设为public

##### 添加Internet权限

##### http usesClearTextTraffic=true

### 个人中心菜单

##### 使用listView开发菜单，默认布局android.R.layout.simplexx

### 条形图柱状图

```java
barChart = findViewById(R.id.barChart);

barChart.setNoDataText("加载中");


http.service.news().enqueue(new CallbackImpl<NewDTO>() {
    @Override
    public void onResponse(Call<NewDTO> call, Response<NewDTO> response) {
        List<NewDTO.RowsDTO> collect = response.body().getRows().stream().limit(5).collect(Collectors.toList());
        String[] tags = new String[5];
        List<BarEntry> entries = new ArrayList<>();
        int i = 0;
        for (NewDTO.RowsDTO dto : collect) {
            tags[i] = dto.getTitle().substring(0,3)+"...";
            entries.add(new BarEntry(i++,dto.getLikeNum()));
        }

        Description description = barChart.getDescription();
        description.setText("点赞量");
        description.setPosition(80,40);
        barChart.setDescription(description);

        XAxis xAxis = barChart.getXAxis();
        xAxis.setPosition(XAxis.XAxisPosition.BOTTOM);
        xAxis.setValueFormatter(new IndexAxisValueFormatter(tags));


        barChart.setData(new BarData(new BarDataSet(entries,"")));
        barChart.invalidate();
```

### 技巧

##### 自定义ListView来避免fragment无法滑动的问题

```java
public class MyListView extends ListView {
    @Override
    protected void onMeasure(int widthMeasureSpec, int heightMeasureSpec) {
        int expand = MeasureSpec.makeMeasureSpec(Integer.MAX_VALUE >> 2, MeasureSpec.AT_MOST);
        super.onMeasure(widthMeasureSpec, expand);
    }

    public MyListView(Context context) {
        super(context);
    }

    public MyListView(Context context, AttributeSet attrs) {
        super(context, attrs);
    }

    public MyListView(Context context, AttributeSet attrs, int defStyleAttr) {
        super(context, attrs, defStyleAttr);
    }

    public MyListView(Context context, AttributeSet attrs, int defStyleAttr, int defStyleRes) {
        super(context, attrs, defStyleAttr, defStyleRes);
    }
}
```

##### 自定义GridView来快速开发全部服务

```java
package com.zjamss.smartcity5.widget;

import android.content.Context;
import android.util.AttributeSet;
import android.widget.GridView;

/**
 * @Program: SmartCity5
 * @Description:
 * @Author: ZJamss
 * @Create: 2022-07-01 09:04
 **/
public class MyGridView extends GridView {
    public MyGridView(Context context) {
        super(context);
    }

    public MyGridView(Context context, AttributeSet attrs) {
        super(context, attrs);
    }

    public MyGridView(Context context, AttributeSet attrs, int defStyleAttr) {
        super(context, attrs, defStyleAttr);
    }

    public MyGridView(Context context, AttributeSet attrs, int defStyleAttr, int defStyleRes) {
        super(context, attrs, defStyleAttr, defStyleRes);
    }

    @Override
    protected void onMeasure(int widthMeasureSpec, int heightMeasureSpec) {
        int expand =  MeasureSpec.makeMeasureSpec(Integer.MAX_VALUE >> 2, MeasureSpec.AT_MOST);
        super.onMeasure(widthMeasureSpec, expand);

    }
}


services.setNumColumns(4);  //设置一行个数

```

##### PATH路径在常量类中初始化

```java
public class Constant {
    public static String PATH;
    public static boolean IS_LOGIN;
    public static String TOKEN;

    static {
        PATH = "http://"+ Util.getSp().getString("ip",null)+":"+Util.getSp().getString("port",null);
    }
}
```

##### 登陆成功设置 IS_LOGIN和 TOKEN然后重启MainActivity

##### UserFragment内onResume()初始化用户数据

```java
@Override
public void onResume() {
    super.onResume();
    if (Constant.IS_LOGIN) {
        http.service.userInfo(Constant.TOKEN).enqueue(new CallbackImpl<UserInfoDTO>() {
            @Override
            public void onResponse(Call<UserInfoDTO> call, Response<UserInfoDTO> response) {
                UserInfoDTO.UserDTO user = response.body().getUser();
                Glide.with(avatar).load(user.getAvatar()).into(avatar);
                name.setText(user.getUserName());
                userDTO = user;
            }
        });
    }
}
```

##### 初始化菜单时，click事件鉴权，未登录则跳转

