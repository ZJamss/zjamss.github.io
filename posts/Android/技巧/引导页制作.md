#### 先制作启动页

```java
//启动页
public class SplashActivity extends AppCompatActivity {

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_splash);

        SharedPreferences sp = getSharedPreferences("open_cache", Context.MODE_PRIVATE);
        boolean first_open = sp.getBoolean("FIRST_OPEN", true);

        if(first_open){
            Intent intent = new Intent(this,GuideActivity.class);
            startActivity(intent);
            finish();
        }else {
            new Handler().postDelayed((Runnable) () -> {
                Intent intent = new Intent(this,MainActivity.class);
                startActivity(intent);
                finish();
            },2000);
        }
    }

}
```

在`onCreate()`方法中**获取sp并判断，是否是第一次启动**，如果是，则跳转到引导页，否则延迟两秒跳转到主页

**并在`AndroidManifest.xml`中设置启动页为Main**

```xml
<activity
            android:name=".SplashActivity"
            android:exported="true">
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />

                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
```

#### 创建多个引导页布局

（因为是实例都差不多，所以只放最后一个）

```xml
<?xml version="1.0" encoding="utf-8"?>
<androidx.constraintlayout.widget.ConstraintLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:app="http://schemas.android.com/apk/res-auto"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:background="@color/teal_200">

    <TextView
        android:id="@+id/textView"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_marginStart="158dp"
        android:layout_marginTop="314dp"
        android:layout_marginEnd="195dp"
        android:layout_marginBottom="398dp"
        android:text="g3"
        android:textSize="60sp"
        app:layout_constraintBottom_toBottomOf="parent"
        app:layout_constraintEnd_toEndOf="parent"
        app:layout_constraintStart_toStartOf="parent"
        app:layout_constraintTop_toTopOf="parent" />

    <Button
        android:id="@+id/enter"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_marginStart="146dp"
        android:layout_marginTop="45dp"
        android:layout_marginEnd="171dp"
        android:text="进入"
        app:layout_constraintEnd_toEndOf="parent"
        app:layout_constraintStart_toStartOf="parent"
        app:layout_constraintTop_toBottomOf="@+id/textView" />
</androidx.constraintlayout.widget.ConstraintLayout>
```

> `button`按钮作用是结束引导页进入主页

#### 创建ViewPager适配器 `GuidePageAdapter`

```java
public class GuidePageAdapter extends PagerAdapter {

    private List<View> mList;

    public GuidePageAdapter(List<View> list){
        mList = list;
    }

    @Override
    public int getCount() {
        return mList.size();
    }

    @Override
    public boolean isViewFromObject(@NonNull View view, @NonNull Object object) {
        return view == object;
    }

    @NonNull
    @Override
    public Object instantiateItem(@NonNull ViewGroup container, int position) {
        container.addView(mList.get(position));
        return mList.get(position);

    }

    @Override
    public void destroyItem(@NonNull ViewGroup container, int position, @NonNull Object object) {
        container.removeView(mList.get(position));
    }
}
```

#### 创建引导页`GuideActivity`

xml文件如下：

```xml
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:app="http://schemas.android.com/apk/res-auto"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical"
    tools:context=".GuideActivity">

    <androidx.viewpager.widget.ViewPager
        android:id="@+id/vp"
        android:layout_width="match_parent"
        android:layout_height="match_parent" />

    <LinearLayout
        android:id="@+id/os"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentBottom="true"
        android:layout_centerHorizontal="true"
        android:layout_gravity="bottom"
        android:layout_marginBottom="40dp"
        android:gravity="center"
        android:orientation="horizontal">

        <View
            android:id="@+id/o1"
            android:layout_width="30dp"
            android:layout_height="30dp"
            android:layout_marginRight="20dp" />

        <View
            android:id="@+id/o2"
            android:layout_width="30dp"
            android:layout_height="30dp"
            android:layout_marginRight="20dp" />

        <View
            android:id="@+id/o3"
            android:layout_width="30dp"
            android:layout_height="30dp" />

    </LinearLayout>

</RelativeLayout>
```

使用`ViewPager`给引导页提供滑动，`RelativeLayout`使圆点组处于页面的中下位置

类如下：

```java
package com.zjamss.guideactivitytest;

import androidx.appcompat.app.AppCompatActivity;
import androidx.viewpager.widget.ViewPager;

import android.content.Context;
import android.content.Intent;
import android.content.SharedPreferences;
import android.os.Bundle;
import android.view.LayoutInflater;
import android.view.View;
import android.widget.Button;
import android.widget.Toast;

import java.util.ArrayList;
import java.util.List;

public class GuideActivity extends AppCompatActivity {

    private int[] guides = new int[]{R.layout.guide1, R.layout.guide2, R.layout.guide3};
    View o1;
    View o2;
    View o3;
    private View[] os;
    private ViewPager vp;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_guide);

        vp = findViewById(R.id.vp);

        List<View> list = new ArrayList<>();
        for (int i = 0; i < guides.length; i++) {
            View view = getLayoutInflater().inflate(guides[i], null);
            if (i == guides.length - 1) {
                Button btn = view.findViewById(R.id.enter);
                btn.setOnClickListener(view1 -> {
                    saveOpenState();
                    Intent intent = new Intent(this, SplashActivity.class);
                    startActivity(intent);
                    finish();
                });
            }
            list.add(view);
        }
        vp.setAdapter(new GuidePageAdapter(list));

        osInit();

        vp.addOnPageChangeListener(new ViewPager.OnPageChangeListener() {
            @Override
            public void onPageScrolled(int position, float positionOffset, int positionOffsetPixels) {

            }

            @Override
            public void onPageSelected(int position) {
                changeOs(position);
            }

            @Override
            public void onPageScrollStateChanged(int state) {

            }
        });
    }

    @Override
    protected void onPause() {
        super.onPause();
        saveOpenState();
        finish();
    }

    private void saveOpenState() {
        SharedPreferences sp = getSharedPreferences("open_cache", Context.MODE_PRIVATE);
        SharedPreferences.Editor editor = sp.edit();
        editor.putBoolean("FIRST_OPEN", false);
        editor.apply();
    }

    private void osInit() {
        o1 = findViewById(R.id.o1);
        o2 = findViewById(R.id.o2);
        o3 = findViewById(R.id.o3);
        os = new View[]{o1, o2, o3};
        for (int i = 0; i < os.length; i++) {
            if (i == 0) {
                os[i].setBackgroundResource(R.color.black);
            } else {
                os[i].setBackgroundResource(R.color.white);
            }
            int item = i;
            os[i].setOnClickListener(view -> {
                vp.setCurrentItem(item,true);
                changeOs(item);
            });
        }
    }

    private void changeOs(int position) {
        for (int i = 0; i < os.length; i++) {
            if (i == position) {
                os[i].setBackgroundResource(R.color.black);
            } else {
                os[i].setBackgroundResource(R.color.white);
            }
        }
    }
}
```

* `guides数组`是三个引导页的资源id
* `o1,o2,o3`是三个小圆点

* `os`是小圆点的数组

在`onCeate()`内，初始化一众参数，设置ViewPager的Adapter

* 在填充GuideView的时候，当填充到最后一个（带Button的），就给`button`设置点击事件，保存打开状态然后启动启动页
* 设置vp的页面改变事件，点亮对应的小圆点
* 小圆点组初始化时，设置背景颜色，绑定点击事件（切换到对应引导页）
